import{d as H,u as I,r as v,m as F,p as R,t as D,e as o,w as a,n as m,i as r,F as z,j as h,b as n,o as L,J as q,f as u,g as s,B as g,_ as J}from"./index-DszLMmwp.js";const W=["href"],G=H({__name:"MyNotificaciones",setup(K){const l=I(),f=v(!1),d=v(null),p=v([]),b=v([]),_=v(""),C=v([{title:"Paciente",key:"nombre_paciente"},{title:"Consultorio",key:"consultorio"},{title:"Fecha",key:"fecha"},{title:"Hora",key:"hora"},{title:"TelÃ©fono",key:"telefono"}]),N=F(()=>d.value?new Date(d.value).toLocaleDateString("es-AR"):""),w=F(()=>l.global.current.value),E=c=>{d.value=c},y=async()=>{try{const c=await h.get("/turnos/calendario",{params:{fecha:d.value}});p.value=c.data,console.log("Turnos cargados:",p.value)}catch(c){console.error("Error al cargar turnos:",c)}},j=async()=>{try{const c=p.value.filter(i=>b.value.includes(i.id_turno)).map(i=>({idTurno:i.id_turno,numero:i.telefono})),e=await h.post("/enviar-notificaciones",{turnos:c,mensajeBase:_.value});console.log(e),b.value=[],_.value=""}catch(c){console.error("Error al enviar notificaciones:",c)}};return R(()=>{y()}),(c,e)=>{const i=n("v-text-field"),A=n("v-date-picker"),$=n("v-menu"),k=n("v-col"),x=n("v-btn"),B=n("v-row"),T=n("v-card-title"),M=n("v-data-table"),V=n("v-card"),O=n("v-textarea"),P=n("v-alert"),S=n("v-card-text"),U=n("v-card-actions");return L(),D(z,null,[o(B,{class:"mt-5"},{default:a(()=>[o(k,{cols:"12",md:"6"},{default:a(()=>[o($,{modelValue:f.value,"onUpdate:modelValue":e[2]||(e[2]=t=>f.value=t),"close-on-content-click":!1,transition:"scale-transition","offset-y":"","min-width":"290px"},{activator:a(({props:t})=>[o(i,q({"model-value":N.value,label:"Filtrar por Fecha","prepend-icon":"mdi-calendar",readonly:""},t,{clearable:"",onClick:e[0]||(e[0]=Q=>f.value=!0),variant:"outlined",density:"compact"}),null,16,["model-value"])]),default:a(()=>[o(A,{modelValue:d.value,"onUpdate:modelValue":[e[1]||(e[1]=t=>d.value=t),E],color:"primary",theme:w.value.dark?"dark":"light",locale:"es"},null,8,["modelValue","theme"])]),_:1},8,["modelValue"])]),_:1}),o(k,{cols:"12",md:"6",class:"d-flex align-center justify-center"},{default:a(()=>[o(x,{color:"primary",onClick:y,disabled:!d.value},{default:a(()=>e[5]||(e[5]=[u(" Filtrar Turnos ")])),_:1},8,["disabled"])]),_:1})]),_:1}),o(V,{style:m({background:r(l).global.current.value.colors.background,color:r(l).global.current.value.colors["on-background"],border:`1px solid ${r(l).global.current.value.colors.border}`})},{default:a(()=>[o(T,{class:"text-h5"},{default:a(()=>e[6]||(e[6]=[u("Turnos Programados")])),_:1}),o(M,{style:m({background:r(l).global.current.value.colors.background,color:r(l).global.current.value.colors["on-background"],border:`1px solid ${r(l).global.current.value.colors.border}`}),headers:C.value,items:p.value,"item-value":"id_turno","show-select":"",modelValue:b.value,"onUpdate:modelValue":e[3]||(e[3]=t=>b.value=t),class:"elevation-1"},{"item.nombre_paciente":a(({item:t})=>[s("strong",null,g(t.nombre_paciente)+" "+g(t.apellido_paciente),1)]),"item.telefono":a(({item:t})=>[s("a",{target:"_blank",style:m({color:r(l).global.current.value.colors["on-background"]}),href:`tel:${t.telefono}`},g(t.telefono),13,W)]),_:1},8,["style","headers","items","modelValue"])]),_:1},8,["style"]),o(V,{class:"mt-5",style:m({background:r(l).global.current.value.colors.background,color:r(l).global.current.value.colors["on-background"],border:`1px solid ${r(l).global.current.value.colors.border}`})},{default:a(()=>[o(T,{class:"text-h5"},{default:a(()=>e[7]||(e[7]=[u("Escribir Mensaje")])),_:1}),o(S,{style:m({background:r(l).global.current.value.colors.background,color:r(l).global.current.value.colors["on-background"],border:`1px solid ${r(l).global.current.value.colors.border}`})},{default:a(()=>[o(O,{class:"mt-3",modelValue:_.value,"onUpdate:modelValue":e[4]||(e[4]=t=>_.value=t),label:"Escribe el mensaje para enviar por WhatsApp",outlined:"",dense:"",rows:"4",required:""},null,8,["modelValue"]),o(P,{type:"info",class:"mt-3"},{default:a(()=>e[8]||(e[8]=[u(" Puedes usar los siguientes marcadores en el mensaje para personalizarlo: "),s("ul",null,[s("li",null,[s("b",null,"{PACIENTE}"),u(": Nombre del paciente")]),s("li",null,[s("b",null,"{CONSULTORIO}"),u(": Nombre del consultorio")]),s("li",null,[s("b",null,"{TRATAMIENTO}"),u(": Tratamiento asignado")]),s("li",null,[s("b",null,"{FECHA}"),u(": Fecha del turno")]),s("li",null,[s("b",null,"{HORA}"),u(": Hora del turno")])],-1)])),_:1})]),_:1},8,["style"]),o(U,null,{default:a(()=>[o(x,{onClick:j,style:m({color:r(l).global.current.value.colors["on-background"],backgroundColor:r(l).global.current.value.colors.primary})},{default:a(()=>e[9]||(e[9]=[u(" Enviar Notificaciones ")])),_:1},8,["style"])]),_:1})]),_:1},8,["style"])],64)}}}),Y=J(G,[["__scopeId","data-v-ba3cd02e"]]);export{Y as default};
