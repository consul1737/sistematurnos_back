import{d as N,u as B,y as $,b as t,c as U,o as h,i as n,I as F,w as a,e,f as k,B as R,n as q,M,r as w,t as G,F as H,_ as W,z as j,g as z,H as L,p as J,l as K}from"./index-DszLMmwp.js";import{u as O}from"./pacientesStores-DteMzXcY.js";const Q=[{title:"Nombre",key:"nombre"},{title:"Apellido",key:"apellido"},{title:"Fecha de Nacimiento",key:"fecha_nacimiento"},{title:"Género",key:"genero"},{title:"Teléfono",key:"telefono"},{title:"Correo Electrónico",key:"email"},{title:"Dirección",key:"direccion"},{title:"Acciones",key:"actions",sortable:!1}],X=N({__name:"DialogConfirmacion",props:{dialog:{type:Boolean},paciente:{}},emits:["confirmar","cancelar"],setup(C,{emit:_}){const i=_,s=B(),f=C,{dialog:m,paciente:x}=$(f),l=()=>{i("confirmar")},p=()=>{i("cancelar")};return(d,r)=>{const y=t("v-card-title"),v=t("v-btn"),o=t("v-card-actions"),E=t("v-card"),V=t("v-dialog");return h(),U(V,{modelValue:n(m),"onUpdate:modelValue":r[0]||(r[0]=P=>F(m)?m.value=P:null),"max-width":"fit-content"},{default:a(()=>[e(E,{class:"pa-8"},{default:a(()=>[e(y,{class:"text-h5 mt-2 mb-10"},{default:a(()=>{var P;return[k(" ¿ Estas seguro de eliminar a "+R((P=n(x))==null?void 0:P.nombre)+" con sus turnos ? ",1)]}),_:1}),e(o,null,{default:a(()=>[e(v,{style:q({color:n(s).global.current.value.colors.info,marginRight:"15px",fontWeight:"bold"}),variant:"tonal",onClick:l},{default:a(()=>r[1]||(r[1]=[k(" Sí ")])),_:1},8,["style"]),e(v,{style:q({color:n(s).global.current.value.colors.error,fontWeight:"bold"}),variant:"tonal",onClick:p},{default:a(()=>r[2]||(r[2]=[k(" No ")])),_:1},8,["style"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),Y=N({__name:"TablaPacientes",props:{pacientes:{type:Array,required:!0}},emits:["abrir-dialog-editar","eliminar-paciente"],setup(C,{emit:_}){M(r=>({"8fe4fe12":n(i).global.current.value.colors.surface,e1ee87d0:n(i).global.current.value.colors["on-background"]}));const i=B(),s=_,f=w(!1),m=w(null),x=r=>{s("abrir-dialog-editar",r)},l=r=>{m.value=r,f.value=!0,console.log("Paciente a eliminar:",m.value)},p=()=>{m.value&&s("eliminar-paciente",m.value.id_paciente),d()},d=()=>{f.value=!1,m.value=null};return(r,y)=>{const v=t("v-icon"),o=t("v-data-table");return h(),G(H,null,[(h(),U(o,{key:C.pacientes.length,headers:n(Q),items:C.pacientes,class:"elevation-2","no-data-text":"No hay pacientes registrados.",style:q({backgroundColor:n(i).global.current.value.colors.background,color:n(i).global.current.value.colors["on-background"],border:`1px solid ${n(i).global.current.value.colors.border}`})},{"item.actions":a(({item:E})=>[e(v,{class:"me-2",size:"small",onClick:V=>x(E)},{default:a(()=>y[0]||(y[0]=[k("mdi-pencil")])),_:2},1032,["onClick"]),e(v,{size:"small",onClick:V=>l(E)},{default:a(()=>y[1]||(y[1]=[k("mdi-delete")])),_:2},1032,["onClick"])]),_:2},1032,["headers","items","style"])),e(X,{dialog:f.value,paciente:m.value,onConfirmar:p,onCancelar:d},null,8,["dialog","paciente"])],64)}}}),Z=W(Y,[["__scopeId","data-v-b6aadb9a"]]),ee={class:"d-flex align-center justify-lg-space-around",style:{width:"100%"}},oe={class:"mr-1"},le=N({__name:"DialogPacientes",props:{isEdit:{type:Boolean},pacienteEditar:{},dialog:{type:Boolean}},emits:["paciente-editado","paciente-agregado","close-dialog"],setup(C,{emit:_}){const i=B(),s=_,f=C,{isEdit:m,dialog:x}=$(f),l=w({nombre:"",apellido:"",fecha_nacimiento:"",genero:"",telefono:"",email:"",direccion:""});j(()=>f.pacienteEditar,v=>{v?l.value={...v}:l.value={nombre:"",apellido:"",fecha_nacimiento:"",genero:"",telefono:"",email:"",direccion:""}},{immediate:!0});const p=w(!0),d={required:v=>!!v||"Campo requerido"},r=()=>{s("close-dialog")},y=()=>{f.isEdit?s("paciente-editado",l.value):s("paciente-agregado",l.value)};return(v,o)=>{const E=t("v-icon"),V=t("v-btn"),P=t("v-toolbar"),u=t("v-text-field"),g=t("v-radio"),b=t("v-radio-group"),D=t("v-form"),S=t("v-card-text"),A=t("v-spacer"),T=t("v-card-actions"),I=t("v-navigation-drawer");return h(),U(I,{modelValue:n(x),"onUpdate:modelValue":o[8]||(o[8]=c=>F(x)?x.value=c:null),"hide-overlay":!0,absolute:"",temporary:"",location:"right","expand-on-hover":"","close-delay":"100",scrim:"#00000000",width:"500",transition:"slide-x-reverse-transition",height:"100vh",style:{overflow:"visible",zIndex:"2000",top:"0",height:"100%"}},{default:a(()=>[e(P,{style:q({backgroundColor:n(i).global.current.value.colors.background,borderBottom:`1px solid ${n(i).global.current.value.colors.border}`,paddingLeft:"15px",paddingTop:"5px",height:"70px",width:"100%"})},{default:a(()=>[z("div",ee,[z("div",oe,[z("span",{style:q({color:n(i).global.current.value.colors["on-background"],fontSize:"20px"})},"Configurar calendario",4),o[9]||(o[9]=z("br",null,null,-1)),z("span",{style:q({color:n(i).global.current.value.colors["on-background"],fontSize:"14px"})},"Personalizar y Previsualizar en Tiempo Real",4)]),e(V,{icon:"",dark:"",onClick:r},{default:a(()=>[e(E,null,{default:a(()=>o[10]||(o[10]=[k("mdi-close")])),_:1})]),_:1})])]),_:1},8,["style"]),e(S,null,{default:a(()=>[e(D,{ref:"form",modelValue:p.value,"onUpdate:modelValue":o[7]||(o[7]=c=>p.value=c)},{default:a(()=>[e(u,{modelValue:l.value.nombre,"onUpdate:modelValue":o[0]||(o[0]=c=>l.value.nombre=c),label:"Nombre",rules:[d.required],required:""},null,8,["modelValue","rules"]),e(u,{modelValue:l.value.apellido,"onUpdate:modelValue":o[1]||(o[1]=c=>l.value.apellido=c),label:"Apellido",rules:[d.required],required:""},null,8,["modelValue","rules"]),e(u,{modelValue:l.value.fecha_nacimiento,"onUpdate:modelValue":o[2]||(o[2]=c=>l.value.fecha_nacimiento=c),label:"Fecha de Nacimiento",type:"date",rules:[d.required],required:""},null,8,["modelValue","rules"]),e(b,{modelValue:l.value.genero,"onUpdate:modelValue":o[3]||(o[3]=c=>l.value.genero=c),row:"",label:"Género",rules:[d.required]},{default:a(()=>[e(g,{label:"Masculino",value:"M"}),e(g,{label:"Femenino",value:"F"})]),_:1},8,["modelValue","rules"]),e(u,{modelValue:l.value.telefono,"onUpdate:modelValue":o[4]||(o[4]=c=>l.value.telefono=c),label:"Teléfono",type:"tel",rules:[d.required],required:""},null,8,["modelValue","rules"]),e(u,{modelValue:l.value.email,"onUpdate:modelValue":o[5]||(o[5]=c=>l.value.email=c),label:"Correo Electrónico",type:"email",rules:[d.required],required:""},null,8,["modelValue","rules"]),e(u,{modelValue:l.value.direccion,"onUpdate:modelValue":o[6]||(o[6]=c=>l.value.direccion=c),label:"Dirección",rules:[d.required],required:""},null,8,["modelValue","rules"])]),_:1},8,["modelValue"])]),_:1}),e(T,null,{default:a(()=>[e(A),e(V,{color:"red",type:"submit",onClick:r},{default:a(()=>o[11]||(o[11]=[k("Cancelar")])),_:1}),e(V,{color:"green",text:"",onClick:y},{default:a(()=>[k(R(n(m)?"Modificar":"Agregar"),1)]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),ae=N({__name:"CompoPacientes",setup(C){const _=B(),i=O(),{pacientes:s}=L(i),{fetchPacientes:f,savePaciente:m,deletePaciente:x,updatePaciente:l}=i,p=w(!1),d=w(!1),r=w(null),y=()=>{p.value=!0},v=()=>{p.value=!1,d.value=!1},o=u=>{r.value=u,d.value=!0,p.value=!0},E=async u=>{try{await m(u),p.value=!1}catch(g){console.error("Error al agregar el paciente:",g)}},V=async u=>{try{await l(u),p.value=!1}catch(g){console.error("Error al actualizar el paciente:",g)}},P=async u=>{var g;try{await x(u.id_paciente);const b=s.value.findIndex(D=>D.id_paciente===Number(u));b!==-1&&(s.value=[...s.value.slice(0,b),...s.value.slice(b+1)],s.value=[...s.value])}catch(b){console.error("Error al eliminar el paciente:",b),K(b)&&((g=b.response)==null?void 0:g.status)===400?alert("No se puede eliminar el paciente porque tiene turnos asociados."):alert("Hubo un error al eliminar el paciente. Inténtalo nuevamente.")}};return J(()=>{f()}),(u,g)=>{const b=t("v-toolbar-title"),D=t("v-btn"),S=t("v-toolbar"),A=t("v-row"),T=t("v-container");return h(),U(T,null,{default:a(()=>[e(A,null,{default:a(()=>[e(S,{style:q({backgroundColor:n(_).global.current.value.colors.surface,color:n(_).global.current.value.colors["on-background"],border:`1px solid ${n(_).global.current.value.colors.border}`,borderRadius:"0.5rem 0.5rem 0 0"}),class:"pa-5"},{default:a(()=>[e(b,{class:"text-h5"},{default:a(()=>g[0]||(g[0]=[k("Gestión de Pacientes")])),_:1}),e(D,{icon:"mdi-account-plus",class:"ml-2 mr-7",onClick:y,style:q({backgroundColor:n(_).global.current.value.colors.primary,color:n(_).global.current.value.colors["on-primary"]})},null,8,["style"])]),_:1},8,["style"])]),_:1}),e(A,null,{default:a(()=>[e(Z,{pacientes:n(s),onAbrirDialogEditar:o,onEliminarPaciente:P},null,8,["pacientes"])]),_:1}),e(le,{dialog:p.value,isEdit:d.value,pacienteEditar:r.value,onPacienteAgregado:E,onPacienteEditado:V,onCloseDialog:v},null,8,["dialog","isEdit","pacienteEditar"])]),_:1})}}}),re=N({__name:"PacientesView",setup(C){return(_,i)=>(h(),U(ae))}});export{re as default};
